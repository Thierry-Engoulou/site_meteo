<!DOCTYPE html>
<html lang="fr">
Â  <head>
Â  Â  <meta charset="UTF-8" />
Â  Â  <title>Dashboard MÃ©tÃ©o Douala</title>
Â  Â  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
Â  Â  <link
Â  Â  Â  href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
Â  Â  Â  rel="stylesheet"
Â  Â  />
Â  </head>
Â  <body class="bg-gray-100 p-6">
Â  Â  Â  Â  <ul>
Â  Â  Â  <li><a href="http://127.0.0.1:5000/">Accueil</a></li>
Â  Â  Â  <li><a href="http://127.0.0.1:5000/previsions">previsions</a></li>
Â  Â  Â  <li><a href="http://127.0.0.1:5000/carte">Carte</a></li>
Â  Â  Â  <li><a href="http://127.0.0.1:5000/a_propos">A propos</a></li>
Â  Â  </ul>

Â  Â  <h1 class="text-3xl font-bold mb-4">ğŸŒ Carte mÃ©tÃ©o & Dashboard</h1>
Â  Â  <div
Â  Â  Â  style="width: 800px; height: 400px; margin: auto; overflow: hidden"
Â  Â  Â  class="mb-8 rounded-2xl overflow-hidden shadow"
Â  Â  >
Â  Â  Â  {{ carte_html|safe }}
Â  Â  </div>

Â  Â  Â  Â  <div class="mb-6 flex justify-center space-x-4">
Â  Â  Â  <button
Â  Â  Â  Â  id="showTemp"
Â  Â  Â  Â  class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
Â  Â  Â  >
Â  Â  Â  Â  TempÃ©rature
Â  Â  Â  </button>
Â  Â  Â  <button
Â  Â  Â  Â  id="showHum"
Â  Â  Â  Â  class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
Â  Â  Â  >
Â  Â  Â  Â  HumiditÃ©
Â  Â  Â  </button>
Â  Â  Â  <button
Â  Â  Â  Â  id="showPress"
Â  Â  Â  Â  class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
Â  Â  Â  >
Â  Â  Â  Â  Pression
Â  Â  Â  </button>
Â  Â  Â  <button
Â  Â  Â  Â  id="showVent"
Â  Â  Â  Â  class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
Â  Â  Â  >
Â  Â  Â  Â  Vent
Â  Â  Â  </button>
Â  Â  </div>

Â  Â  Â  Â  <div class="bg-white p-4 rounded-2xl shadow" style="display: none;" id="chartContainer">
Â  Â  Â  <canvas id="myChart" width="800" height="400"></canvas>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  const labels = {{ labels|tojson }};
Â  Â  Â  // Chaque dataset
Â  Â  Â  const datasets = {
Â  Â  Â  Â  temp: Â  Â { data: {{ temps|tojson }}, Â  Â borderColor: 'rgba(255,99,71,1)', Â  Â bg: 'rgba(255,99,71,0.2)' },
Â  Â  Â  Â  hum: Â  Â  { data: {{ humidite|tojson }}, borderColor: 'rgba(30,144,255,1)', Â  bg: 'rgba(30,144,255,0.2)' },
Â  Â  Â  Â  press: Â  { data: {{ pression|tojson }}, borderColor: 'rgba(50,205,50,1)', Â  Â bg: 'rgba(50,205,50,0.2)' },
Â  Â  Â  Â  vent: Â  Â { data: {{ vent|tojson }}, Â  Â  borderColor: 'rgba(218,165,32,1)', Â bg: 'rgba(218,165,32,0.2)' }
Â  Â  Â  };

Â  Â  Â  const ctx = document.getElementById('myChart').getContext('2d');
Â  Â  Â  let myChart;

Â  Â  Â  function createChart(label, data) {
Â  Â  Â  Â  if (myChart) {
Â  Â  Â  Â  Â  myChart.destroy();
Â  Â  Â  Â  }
Â  Â  Â  Â  myChart = new Chart(ctx, {
Â  Â  Â  Â  Â  type: 'line',
Â  Â  Â  Â  Â  data: {
Â  Â  Â  Â  Â  Â  labels: labels,
Â  Â  Â  Â  Â  Â  datasets: [{
Â  Â  Â  Â  Â  Â  Â  label: label,
Â  Â  Â  Â  Â  Â  Â  data: data.data,
Â  Â  Â  Â  Â  Â  Â  borderColor: data.borderColor,
Â  Â  Â  Â  Â  Â  Â  backgroundColor: data.bg,
Â  Â  Â  Â  Â  Â  Â  tension: 0.3,
Â  Â  Â  Â  Â  Â  Â  fill: true,
Â  Â  Â  Â  Â  Â  Â  pointRadius: 2
Â  Â  Â  Â  Â  Â  }]
Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  options: {
Â  Â  Â  Â  Â  Â  responsive: false, // Important : false pour la taille fixe
Â  Â  Â  Â  Â  Â  maintainAspectRatio: false,
Â  Â  Â  Â  Â  Â  // DÃ©finir une taille fixe pour le canvas
Â  Â  Â  Â  Â  Â  width: 800,
Â  Â  Â  Â  Â  Â  height: 400,
Â  Â  Â  Â  Â  Â  scales: {
Â  Â  Â  Â  Â  Â  Â  y: {
Â  Â  Â  Â  Â  Â  Â  Â  beginAtZero: false
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  plugins: {
Â  Â  Â  Â  Â  Â  Â  legend: {
Â  Â  Â  Â  Â  Â  Â  Â  display: false
Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  tooltip: {
Â  Â  Â  Â  Â  Â  Â  Â  mode: 'index',
Â  Â  Â  Â  Â  Â  Â  Â  intersect: false
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  Â  Â  document.getElementById('chartContainer').style.display = 'block';
Â  Â  Â  }

Â  Â  Â  document.getElementById('showTemp').addEventListener('click', () => {
Â  Â  Â  Â  createChart('TempÃ©rature (Â°C)', datasets.temp);
Â  Â  Â  });
Â  Â  Â  document.getElementById('showHum').addEventListener('click', () => {
Â  Â  Â  Â  createChart('HumiditÃ© (%)', datasets.hum);
Â  Â  Â  });
Â  Â  Â  document.getElementById('showPress').addEventListener('click', () => {
Â  Â  Â  Â  createChart('Pression (hPa)', datasets.press);
Â  Â  Â  });
Â  Â  Â  document.getElementById('showVent').addEventListener('click', () => {
Â  Â  Â  Â  createChart('Vent (m/s)', datasets.vent);
Â  Â  Â  });

Â  Â  Â  // Actualiser les donnÃ©es toutes les 10 minutes (600000 ms)
Â  Â  Â  setInterval(() => {
Â  Â  Â  Â  // Simuler une requÃªte AJAX pour obtenir de nouvelles donnÃ©es (Ã  remplacer par votre propre logique)
Â  Â  Â  Â  fetch('/nouvelles_donnees')
Â  Â  Â  Â  Â  .then(response => response.json())
Â  Â  Â  Â  Â  .then(newData => {
Â  Â  Â  Â  Â  Â  // Mettre Ã  jour les donnÃ©es du graphique avec les nouvelles donnÃ©es
Â  Â  Â  Â  Â  Â  if (myChart) {
Â  Â  Â  Â  Â  Â  Â  // Assurez-vous que newData contient les mÃªmes propriÃ©tÃ©s que votre structure de donnÃ©es originale
Â  Â  Â  Â  Â  Â  Â  myChart.data.labels = newData.labels;
Â  Â  Â  Â  Â  Â  Â  myChart.data.datasets[0].data = newData.data[myChart.data.datasets[0].label.split(' ')[0].toLowerCase()]; // Ajuster pour accÃ©der aux donnÃ©es correctes
Â  Â  Â  Â  Â  Â  Â  myChart.update();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  .catch(error => console.error('Erreur lors de la rÃ©cupÃ©ration des nouvelles donnÃ©es:', error));
Â  Â  Â  }, 600000);
Â  Â  </script>
Â  </body>
</html>
